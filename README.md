<div align="center">
<a href="https://xiaoqiangclub.51vip.biz/" alt="logo" ><img src="https://gitee.com/xiaoqiangclub/XiaoqiangUpdater/raw/main/img/logo.png" width="120"/></a>
</div>
<h1 align="center">XiaoqiangUpdater</h1>

<div align="center">


ğŸš€ ç¨‹åºå‡çº§å°å·¥å…· ğŸš€

[![GitHub license](https://img.shields.io/github/license/xiaoqiangclub/XiaoqiangUpdater?style=flat-square)](LICENSE)
[![Release Version](https://img.shields.io/github/v/release/xiaoqiangclub/XiaoqiangUpdater?style=flat-square)](https://github.com/xiaoqiangclub/XiaoqiangUpdater/releases/latest)
[![GitHub Star](https://img.shields.io/github/stars/xiaoqiangclub/XiaoqiangUpdater?style=flat-square)](https://github.com/xiaoqiangclub/XiaoqiangUpdater/stargazers)
[![GitHub Fork](https://img.shields.io/github/forks/xiaoqiangclub/XiaoqiangUpdater?style=flat-square)](https://github.com/xiaoqiangclub/XiaoqiangUpdater/network/members)
[![GitHub issues](https://img.shields.io/github/issues/xiaoqiangclub/XiaoqiangUpdater?style=flat-square)](https://github.com/xiaoqiangclub/XiaoqiangUpdater/issues)
<br>
[![PyPI v](https://img.shields.io/pypi/v/XiaoqiangUpdater?style=flat-square&color=%23a8e6cf)](https://pypi.org/project/XiaoqiangUpdater/)
[![PyPI wheel](https://img.shields.io/pypi/wheel/XiaoqiangUpdater?style=flat-square&color=%23dcedc1)](https://pypi.org/project/XiaoqiangUpdater/#files)
[![PyPI pyversions](https://img.shields.io/pypi/pyversions/XiaoqiangUpdater?color=%23ffaaa5&style=flat-square)](https://pypi.org/project/XiaoqiangUpdater/)
<br>
</div>


# 
> XiaoqiangUpdater æ˜¯ä¸€ä¸ªé€šç”¨çš„ç¨‹åºæ›´æ–°æ¨¡å—ï¼Œä¸»è¦ä¸º Windows
> é¡¹ç›®è®¾è®¡ï¼Œä½†ç†è®ºä¸Šä¹Ÿé€‚ç”¨äºå…¶ä»–å¹³å°ï¼Œç”¨æˆ·å¯æ ¹æ®éœ€æ±‚è‡ªè¡Œæ‰“åŒ…å’Œæµ‹è¯•ã€‚è¯¥æ¨¡å—æä¾›è‡ªåŠ¨æ£€æµ‹ã€ä¸‹è½½å’Œå®‰è£…æ›´æ–°çš„åŠŸèƒ½ï¼Œå¹¶èƒ½åœ¨æ›´æ–°å®Œæˆåè‡ªåŠ¨é‡å¯ä¸»åº”ç”¨ç¨‹åºã€‚å¼€å‘è¿™ä¸ªæ¨¡å—çš„åˆè¡·æ˜¯ä¸ºäº†ç®€åŒ–ç¨‹åºå¼€å‘ä¸­çš„å‡çº§æµç¨‹ï¼Œè®©å¼€å‘è€…å¯ä»¥æ–¹ä¾¿åœ°è°ƒç”¨æ¨¡å—å®ç°è‡ªåŠ¨æ›´æ–°ã€‚


**ä½¿ç”¨è¯¥æ¨¡å—éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š**

1. ä½ çš„é¡¹ç›®å‘å¸ƒæ—¶æ‰“åŒ…æˆä¸€ä¸ª`zipæ ¼å¼`çš„å‹ç¼©åŒ…ã€‚
2. ä½ çš„é¡¹ç›®éœ€è¦æä¾›ä¸€ä¸ª`exeå…¥å£æ–‡ä»¶`ï¼Œç”¨äºå¯åŠ¨æ›´æ–°ç¨‹åºã€‚
3. ä½ çš„é¡¹ç›®å¦‚æœæ˜¯å¤šç›®å½•å¤šæ–‡ä»¶ï¼Œexeæ–‡ä»¶éœ€è¦åœ¨ä½ é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚
4. å½“ä½ å‘å¸ƒæ–°ç‰ˆæœ¬çš„æ—¶å€™ï¼Œå»ºè®®ä¿æŒ`exeå…¥å£æ–‡ä»¶å`ä¸å˜ï¼ˆä¾‹å¦‚ï¼š`app.exe`ï¼‰ï¼Œå¦åˆ™éœ€è¦ä½ æ¯æ¬¡éƒ½åœ¨`updater_config.json`
   ä¸­ä¿®æ”¹`main_app`å­—æ®µã€‚

## æŠ€æœ¯æ ˆ

- Python 3.11.5
- requests
- tkinter
- psutil
- pyinstaller

## å®‰è£…

ä½¿ç”¨ pip å®‰è£…ï¼š

```sh
pip install XiaoqiangUpdater
```

## ä½¿ç”¨è¯´æ˜

### å‚æ•°è¯´æ˜

ä½¿ç”¨æ›´æ–°ç¨‹åº `updater` æ—¶ï¼Œå¯ä»¥æŒ‡å®šä»¥ä¸‹å‚æ•°ï¼š

- `config_path`ï¼šé…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤ä¸º `updater_config.json`
  ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šå…·ä½“çš„é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œç¨‹åºå°†è‡ªåŠ¨åœ¨å½“å‰ç›®å½•ä¸‹éå†æŸ¥æ‰¾ä¸€ä¸ªåå« `updater_config.json` çš„é…ç½®æ–‡ä»¶ã€‚ï¼‰
- `--help`ï¼šæ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯å¹¶é€€å‡ºã€‚

### é…ç½®æ–‡ä»¶è¯´æ˜

ç¤ºä¾‹é…ç½®æ–‡ä»¶ `updater_config.json` çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
  "current_version": "1.0.0",
  "latest_version": "1.1.0",
  "update_url": "http://example.com/updater.zip",
  "main_app": "app.exe",
  "verify_file_md5": "d41d8cd98f00b204e9800998ecf8427e",
  "logo_path": "path/to/logo.png",
  "open_current_version_on_fail": true,
  "install_dir": "path/to/install/directory"
}
```

#### é…ç½®é¡¹è¯´æ˜

- `current_version`ï¼šå½“å‰ç‰ˆæœ¬å·ã€‚
- `latest_version`ï¼šæœ€æ–°ç‰ˆæœ¬å·ã€‚
- `update_url`ï¼šæ›´æ–°åŒ…çš„ä¸‹è½½URLã€‚
- `main_app`ï¼šä¸»ç¨‹åºçš„è·¯å¾„ï¼ˆç›¸å¯¹è·¯å¾„ï¼šä¸€èˆ¬éƒ½æ˜¯æ”¾åœ¨æ ¹ç›®å½•ä¸‹çš„exeå…¥å£æ–‡ä»¶ï¼‰ã€‚
- `verify_file_md5`ï¼šæ›´æ–°åŒ…æ ¡éªŒæ–‡ä»¶çš„MD5å€¼ï¼ˆå¯é€‰ï¼‰ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨æ¨¡å—ä¸­çš„`get_file_md5`æ–¹æ³•è·å–ã€‚
- `logo_path`ï¼šå›¾å½¢ç”¨æˆ·ç•Œé¢çš„å›¾æ ‡è·¯å¾„ï¼ˆå¯é€‰ï¼‰ã€‚
- `open_current_version_on_fail`ï¼šæ›´æ–°å¤±è´¥æˆ–å–æ¶ˆæ—¶æ˜¯å¦æ‰“å¼€å½“å‰ç‰ˆæœ¬çš„ç¨‹åºï¼ˆå¯é€‰ï¼‰ã€‚é»˜è®¤æ˜¯ `True`ã€‚
- `install_dir`ï¼šè½¯ä»¶è§£å‹æ›´æ–°çš„ç›®å½•ï¼ˆå¯é€‰ï¼‰ã€‚é»˜è®¤æ˜¯ `updater.exe` æ‰€åœ¨çš„ç›®å½•ã€‚

**æ³¨æ„ï¼š**

1. æ¨¡å—ä¼šè‡ªåŠ¨ä½¿ç”¨ `updater.exe` æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸è®¾ç½®çš„ç›¸å¯¹è·¯å¾„æˆ–ç›®å½•åè¿›è¡Œæ‹¼æ¥ã€‚
2. å¦‚æœæ²¡æœ‰æŒ‡å®šå…·ä½“çš„é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œç¨‹åºå°†è‡ªåŠ¨åœ¨å½“å‰ç›®å½•ä¸‹éå†æŸ¥æ‰¾ä¸€ä¸ªåå« `updater_config.json` çš„é…ç½®æ–‡ä»¶ã€‚

#### ç”Ÿæˆç¤ºä¾‹é…ç½®æ–‡ä»¶

- ä½ å¯ä»¥è°ƒç”¨`updater_config_exampleæ–¹æ³•`å¿«é€Ÿç”Ÿæˆä¸€ä¸ªç¤ºä¾‹é…ç½®æ–‡ä»¶ï¼š

   ```python
   from XiaoqiangUpdater import updater_config_example

   if __name__ == '__main__':
       updater_config_example(save_path='updater_config.json')
   ```

### æ‰“åŒ…æ›´æ–°ç¨‹åº

**ç›´æ¥ä½¿ç”¨**

- ç¬¬ä¸€ç§æ–¹å¼å¯ä»¥ç›´æ¥ä¸‹è½½æ‰“åŒ…å¥½çš„é€šç”¨exeæ–‡ä»¶ï¼š[æœ€æ–°ç‰ˆä¸‹è½½åœ°å€](https://github.com/xiaoqiangclub/XiaoqiangUpdater/releases)

**æ‰‹åŠ¨æ‰“åŒ…**

- é…ç½®updater(å¯é»˜è®¤)
   ```python
   from XiaoqiangUpdater import (updater, updater_config_example)

   
   def test_updater():
       updater_config_example(save_path='updater_config.json') # è¿™é‡Œä¸ºäº†æ–¹ä¾¿ç”Ÿæˆä¸€ä¸ªç¤ºä¾‹é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œéœ€è¦ä½ æ ¹æ®è‡ªå·±çš„é¡¹ç›®å»ç”Ÿæˆ
       updater(config_path='updater_config.json')   # æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„ï¼Œä¸æŒ‡å®šï¼šé»˜è®¤ä¼šè‡ªåŠ¨åœ¨å½“å‰ç›®å½•ä¸‹éå†æŸ¥æ‰¾åä¸ºupdater_config.jsonçš„é…ç½®æ–‡ä»¶
   
   
   if __name__ == '__main__':
       test_updater()
   ```

- è°ƒç”¨`pack_to_exe`æ–¹æ³•ï¼Œå°† `your_updater` æ‰“åŒ…æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š
   ```python
   from XiaoqiangUpdater import pack_to_exe
   
   if __name__ == '__main__':
       pack_to_exe(main_file='test_updater.py', with_cmd_window=False, app_ico_logo=None)
   ```

## é¡¹ç›®ä¸­ä½¿ç”¨ç¤ºä¾‹

```python
# _*_ coding : UTF-8 _*_
# å¼€å‘äººå‘˜ï¼š Xiaoqiang
# å¾®ä¿¡å…¬ä¼—å·: xiaoqiangclub
# å¼€å‘æ—¶é—´ï¼š 2024/5/25 11:01
# æ–‡ä»¶åç§°ï¼š app.py
# é¡¹ç›®æè¿°ï¼š æµ‹è¯•ç¨‹åº
# å¼€å‘å·¥å…·ï¼š PyCharm
import os
import json
import subprocess
import sys
import tkinter as tk
from tkinter import ttk
from XiaoqiangUpdater import updater, updater_config_example


def app():
    root = tk.Tk()
    root.title("XiaoqiangClub")

    # è®¾ç½®çª—å£å¤§å°
    root.geometry("400x200")

    # è®¾ç½®çª—å£å›¾æ ‡
    try:
        root.iconphoto(True, tk.PhotoImage(file="xiaoqiangclub_logo.png"))
    except Exception as e:
        print(f"Error loading logo: {e}")

    # åˆ›å»ºæ ‡ç­¾
    label = ttk.Label(root, text="XiaoqiangClub v1.0.0", font=("Helvetica", 24))
    label.pack(expand=True)

    root.mainloop()


def generate_config():
    """
    æ³¨æ„ï¼šè¿™ä¸ªå‡½æ•°ä»…ç”¨äºç”Ÿæˆç¤ºä¾‹é…ç½®æ–‡ä»¶ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­éœ€è¦ä½ è‡ªå·±å»å†™è¿™ä¸ªå‡½æ•°ã€‚
    """
    config_path = os.path.join(os.getcwd(), "updater_config.json")
    updater_config_example(save_path=config_path)
    print(f"é…ç½®æ–‡ä»¶å·²ç”Ÿæˆï¼š{config_path}")


# ç”¨äºç”Ÿäº§ç¯å¢ƒè°ƒç”¨exeæ–‡ä»¶
def main():
    try:
        # è°ƒç”¨ç”Ÿæˆé…ç½®æ–‡ä»¶å‡½æ•°
        generate_config()
        # è°ƒç”¨æ›´æ–°ç¨‹åº
        updater_path = os.path.join(os.getcwd(), "updater.exe")
        subprocess.Popen([updater_path])
        sys.exit()
    except Exception as e:
        print(f"æ£€æŸ¥æ›´æ–°æ—¶å‡ºé”™: {e}")


# ä»…ç”¨äºæµ‹è¯•ï¼Œè°ƒç”¨updater.pyä¸­çš„start_updateå‡½æ•°
def main_test():
    try:
        # è°ƒç”¨ç”Ÿæˆé…ç½®æ–‡ä»¶å‡½æ•°
        generate_config()
        # è°ƒç”¨æ›´æ–°é€»è¾‘
        updater("updater_config.json")
        sys.exit()
    except Exception as e:
        print(f"æ£€æŸ¥æ›´æ–°æ—¶å‡ºé”™: {e}")


if __name__ == "__main__":
    # ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼š
    # main()

    # æµ‹è¯•ä½¿ç”¨ï¼š
    main_test()
    # å¯åŠ¨åº”ç”¨ç¨‹åº
    app()
```

## æ³¨æ„äº‹é¡¹

- `generate_config`æ–¹æ³•éœ€è¦ä½ è‡ªå·±å»å†™ï¼Œç”¨äºç”Ÿæˆé…ç½®æ–‡ä»¶ã€‚
- è¯·ç¡®ä¿æ›´æ–°URLå’Œæ–‡ä»¶è·¯å¾„æ­£ç¡®ï¼Œå¹¶ä¸”æ›´æ–°åŒ…å®Œæ•´ã€‚
- ä¸ºäº†ç¡®ä¿å®‰å…¨ï¼Œå»ºè®®éªŒè¯ä¸‹è½½æ–‡ä»¶çš„å®Œæ•´æ€§ã€‚
- è¯·æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ä¸»åº”ç”¨ç¨‹åºä¸­çš„æ›´æ–°æ£€æŸ¥é€»è¾‘å’Œå‚æ•°é…ç½®ã€‚

![æ”¯æŒæˆ‘](https://gitee.com/xiaoqiangclub/xiaoqiangapps/raw/master/images/xiaoqiangclub_ad.png)