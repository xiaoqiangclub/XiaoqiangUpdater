![XiaoqiangUpdater](https://socialify.git.ci/xiaoqiangclub/XiaoqiangUpdater/image?description=1&descriptionEditable=&font=Inter&forks=1&issues=1&logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAAFzpJREFUeF7tXX2MXcdVn%2Fu%2B9sOfsRsL23XjuPJHmoqUoKrvWVVqY2iDmqYiqCr8hV0BRVSgUIhECsgbQVGkpmpCQ5qiJOtUIlCptI5p6eKkXjdC1YIaFRAVTYB6oXYa7DZesl3v%2B9j3Lsx6X3h5fu%2FdO%2FfOxzkzv%2F0nH2%2FmzJnfOed3z5yZuTcS%2BAMCQCBYBKJgZ46JAwEgIEAAcAIgEDACIICAjY%2BpAwEQAHwACASMAAggYONj6kAABAAfAAIBIwACCNj4mDoQAAHAB4BAwAiAAAI2PqYOBEAA8AEgEDACIICAjU9x6nG1enRNrxvW%2Fvl1IcR8NDc3T1Ff7jqBALhb0BP9VwM%2Fio4LIXYPmNK8iOP7hBBnQQR6DQ4C0IsnpGVAIK7VZv8vuA%2Bl6HpWxPExkEAKpFI2AQGkBArNzCAQV6vTIoq6aX%2FyIHE8JYR4EiSQDFWaFiCANCihjREE1tL%2BaWXhcTwVzc3JJQH%2BciIAAsgJILpnQyCuVneLKDqXrbcQAiSQGbrejiAALTBCiAoCuYO%2FO1gc34ilgAry17YFAeTDD70zIKBQ9EuSLncHDoMEkmAa%2FjsIIDt26JkBgbhaPS6iSBbydP2BBHIgCQLIAR66qiEQV6uHRBTJLT%2B9f6gHZMYTBJAZOnRUQUDbun%2FYoCABFXO81hYEkAk2dFJFIK7VZMV%2F0Ck%2FVVHD2189JHRCn0D%2FJYEA%2FLex8xlqLPolzwU7A8kY9bQAASjBhcaqCBgo%2BiWpgKJgEkIgAAWE0DQzAsaKfskagQSSMVptgQwgJVBopoaA8aJfkjooCiYhBAJIhRAaZULA6rp%2FmIYggUTbIQNIhAgNVBEgEfxdpbEzMNJ8IABV70b7kQhkvuFnElfsDAxFFwRg0vECk%2B2w6JeENIqCQxACASS5Dn5PhYDzol%2ByliCBARiBAJIdBy1SIEBq3Y%2BiYAqLXW0CAkgNFRoOjSv9N%2FzMgY2dgddhCwIw52pBSCZZ9EtC%2Fuo7BM4mNQvhdxBACFY2NEcG6%2F7hM8fOAJYAhuIiCLFrwS%2Fv9pu94WcOTRQFUQMw512%2BS2ZR9Es2QvDfGcASINlJ0KIPAQc3%2FMzZIPCiIAjAnGt5KZnwYZ%2FseAdMAiCA7G4TXE%2FWRb8kawW6MwACSHIM%2FP4aAp6s%2B7Ez0IMACAABngoB74P%2FKgrB7QyAAFK5f9iNvCr6JZkyjuVLRe8L5WMjIIAkhwj8dy%2BLfkk2DagoCAJIcoaAf%2Fe66Jdk10BIAASQ5AgB%2Fx7Iuj%2FooiAIIOAAHzX1uFqdFlF0NHh4PL8zAAII3sOvBYDlDT9zdvR6ZwAEYM5xWEoOsuiXZCmPdwZAAEnGD%2Bj3oIt%2BSXb2tCgIAkgyfEC%2FB1%2F0S7K1hyQAAkgyeiC%2FB3XYJ49NPSsKggDyOIMnfbHuVzKkV0VBEICS7f1rjHV%2FJpt6QwIggEz296OTB6%2F1cmeIOJ4SQjzJ%2Fc4ACMCdCzkfGUW%2FnCbwoCgIAsjpA1y7o%2BinyXLMSQAEoMkPOIlB0U%2BztRjvDIAANPsCdXEo%2BhmxENuiIAjAiD%2FQFYp1vzHbsCQBEIAxf6AnGMFv2CYM6wEgAMM%2BQUU8in6WLMGMBEAAlvzC5TAo%2BllGnxEJgAAs%2B4bt4VD0s4342nhMdgZAAI78w9awWPfbQvqacVgUBUEAzvzD%2FMB4rZd5jBNGIE8CIADnPmJGAbzWywyuylKJ1wNAAMoWpd8B635iNiJMAiAAYr6SVx0Ef14EDfWP42PR3Jz86hCpPxAAKXPkVwZFv%2FwYGpNAcGcABGDM2vYF47CPfcwVRyRXFAQBKFqQanMc9qFqGdrbgyAANn4zXFGs%2B5kZkVBREATAzHcGqRvXaueEELs9mEo4UyBCAiAA5i6Hoh9jAxLYGQABcPafavW4iCL5ckr8cUXA8c4ACICp46Dox9Rw16rtdGcABMDQj1D0Y2i00SqfFVeXA%2FO2ZwYCsI24hvGw7tcAIjURjoqCIABqjpCgD4KfmcFU1HVAAiAAFQM5bosbfo4NYGP4OD4czc2dtTGUHAMEYAvpnOOg6JcTQE7dLe4MgAAYOAaKfgyMpFdFazsDIAC9hjMiDet%2BI7DSFhrH8urwfaZ3BkAAtN1A4IYfcQOZVM9CURAEYNKAOWWj6JcTQB%2B6GyYBEABRJ8G6n6hhXKhlcGcABODCoEl7%2FdXqbhFFs7jhR9A4rlQytDMAAnBl0BHjouhH0CjuVTKyMwACcG%2FY12mAoh8xg1BSx8DOAAiAkIFx2IeQMaiqorkoCAIgYmgU%2FYgYgoMaGkkABEDE4Fj3EzEEFzU0FQVBAAQMjuAnYASOKmggARCAY8Oj6OfYALyHz70zAAJw6AAo%2BjkE35eh41i%2BE%2FLJrHcGQACOHAFFP0fA%2BzhsjqIgCMCRQ2Dd7wj4hGFbhYpoRhVl5VrFMeU%2Bozo0C2o6rG%2B9%2Bkfr%2Fu7ZP1BVAgSgipiG9v96%2B4e%2FOL6y%2FHNZRKk6Rpox0jrvvlf%2FRZQ7zTQi2baZX7dXLJU3sNR%2FMl4%2BsGfmiRdUlAcBqKCloe23fvY3f6cs2p%2FQIMq6iBAI4MUNN4u0hGjdAAkDRnHn%2BxOicViFBEAAFq344pFjdzQrk39tcUitQ4VAAN%2FefKtWzGwL29K4eL5e2fDTaUkABGDJQt%2B9%2FUP7r0QT37E0nJFhfCcAuf5%2FceNbjWBnU2ip3XjwwOnHfivNmCCANChpaPOP7737%2BVKnxfrx4jsBLBXXi%2FkN%2BzRY272ItCQAArBgq%2B%2B8%2B5c%2FtVIcu9vCUEaH8J0AFipbxYXJG4xiaFN4mqIgCMCwRXxI%2FbsQ%2BU4AF8e3i0vj2w17hD3xlZX63fueefyhUSOCAAzbY%2FbOqV%2B4vnXpLwwPY0U8CMAKzNoGKcYrX7pp5rN3gQC0QaouyJf0X87cdwLgfAZgkGcW4%2FY3b5p59O0gAPW41dbj7%2B%2F43c%2Bsay%2F%2BmjaBDgX5TgCczwAMcot2XDh1y8yn3w8CcBg037jzY%2FdubP3PHztUQdvQvhMA9zMA%2FYZOsxOAGoC28Bgs6Pn3%2FvZdY536Xxkexop4nwnAlzMAvY6AXQArYZE8iA9nAHyvAfh0BkDaKs3TX7ZDBpAcv7lbyK3AZTE2G0cF1ntMPmcAPp0BSFP86zo1CCB3eKcTIC8BVeLWRzmTgM8E4MsZgJVC6eG3feWh30jnlcgA0uKkpd1zd079%2BKbmD%2F%2BwGHXu1CLQshCfCUCeAJRZgPxbiUov64K2WRhLLasSNztpxm2Iyvd7242JxrkrxXUv%2FdmtH%2F%2FUiamonkYGMgAVlDS3lbcCpchOsXhEh%2Bjl4uSFfjnrVpZaeWUvVjZ%2Fr1fGra9845O%2Bfq6suwNwqXz9Lz556%2FGTo7BTDbK8djDZH0sAk%2Bh6Jjuu1c75SAC9OwCSAA6fmvpLz0w3dDoggFAsrWGevhJA7w7A7%2B9%2F%2BLqTD0YLGuBiIQIEwMJMNJT0lQB6C4Bv%2FeqfBhUTQU2WRhjx1cJ3ApDFv7f9zUOst2pVvQsEoIpYwO3jWi32cfrdS0DynXo3z3xmh49zHDYnEEBI1s45Vx8JoLcAqHKAJieUZLqDAMiYgr4i%2FhNA8v15%2BlZS0xAEoIZX0K19JIDeAmDa8%2FM%2BOQEIwCdrGp4LCMAwwA7EgwAcgM5xSF%2B%2FZdj7FqDr6j%2F4yM7Zzz%2FC0T5ZdQYBZEUusH6%2BEkDvS0AqzSvv2%2Fe16S%2BHZFoQQEjWzjFXHwmg%2FyUgN19%2B%2Fsasn9nOAa3TriAAp%2FDzGdxHAugtAJbbDbH%2F9GPBxUNwE%2BYTcrQ09ZEAetf%2FIR4Ckh4GAqAVZ2S18ZEAetf%2FY%2B36S3tPP76TrAEMKQYCMASsb2LjavWQiKJZX%2BbVv%2F6fXFn8wp5nPvcBX%2BaXdh4ggLRIBd4urlaPiiia9gWG%2FleAhXgICEsAX7zZwjziavW4iKIpC0NZGaL%2FIyCNwvjP%2F%2BRXPvlFK4MTGgQZACFjUFbFJwIY9A2A0F4E0vU1EADlqCOkW1yryfX%2FIUIqZValP%2F0P8T0AIIDM7hNmR58JINQtQNQAwozlTLP26SJQ%2FzcA03xGOxNoDDphCcDASBRU9IUABq3%2FQ90BQAZAIbIY6ODTIaBBXwAK8RIQagAMAo%2BKij4dAuo9%2FtvFN8RLQCAAKtHFQA9fDgENSv9DvQQEAmAQeFRU9OUMwKD0P9Q7ACAAKtHFQA9fCGBQ%2Bh9yARBFQAbBR0HFuFqdFlF0lIIuWXUYlP5LWduWzt%2B%2F7bmn780ql3s%2FbANyt6AF%2FX04BDQo%2FZfQhfYpsH53AQFYCCDOQ%2FiyBdh%2F%2BWc1%2FQ3wS0AgAM7R6EB3HwhgWPrfjgunbpn59PsdwEpmSGQAZExBUxEfCoDD0v%2FQC4AoAtKMOVJa%2BUAA%2FWf%2FuwCHfAIQ24CkwoyuMtwLgEvF9WJ%2Bw75rAMb6%2FyokWALQjT3nmvmw%2Fr8weYNYqGy9BssQvwQ8yKFAAM7DjK4C3AlgWPFPIo71PzIAupFHRDPu6%2F9hxT8J7%2FbGhfdsPXPyNBGonamBDMAZ9PQH5k4Ag%2Fb%2BV9e92P9%2FzflAAPTj0JmGnAuAo9L%2FTa3Lc7uefarmDFhCA4MACBmDmiqc3wI0rPgnMQ79%2FH%2Bvn4EAqEUdEX04FwBHPf0lvKGf%2FwcBEAkyympwXv%2BPevpj%2Ff96r0MGQDkKHerGdf2f9PTH9h8IwGFY8Riac%2Fo%2FautPov%2FAOx6eODEV1XlYwryWyADMY8xuBK7pf9LTH%2Bn%2Fta4IAmAXnuYV5koASU9%2FpP8gAPPR48EIHLf%2Fkp7%2B0iyT8fKBPTNPvOCBibRNARmANij9EMR1%2FZ%2F09Ef6P9g%2FQQB%2BxK22WXBN%2F4fd%2Be8Cg%2FQfBKAtSHwWFNdq54QQuznNMenpL%2BcS8td%2FRtkSGQAnTzesK8f0P83aP%2FSPf4AADAeOL%2BI5pv%2BjTv117bKxcfmBN5156h5f7KRzHsgAdKLJXBa3039pnv4o%2Fo12ShAA86DVpT7H9H%2FYff9eTFD8AwHoihGv5XBL%2F9MU%2FrD3n%2ByyyACSMQqiBafqf5rUXxoN6X%2By64IAkjHyvgW39D%2Ft078livf8xFf%2F5AHvDZhjgiCAHOD50pXT13%2Fx9NfrdSAAvXiyk8bt6T%2B%2Fbq9YKm9IxBnFv0SIVhuAANLh5G0rTsW%2FYV%2F56TdOud0Q%2B08%2FBt9O4bUAKQVIPjfhcvMvbeovbYWnf3qPBQGkx8q7lpye%2FmlTf2kknPtP76oggPRYedeSy9Zf2qo%2Fnv7qLgoCUMfMix5cin8qqT%2Be%2FuquCQJQx8yLHlzS%2FzTHfbsGwdpf3TVBAOqYse%2FB5emf5qZfrzHwxl911wQBqGPGvgeHp3%2FaLT88%2FfO5IwggH37senN4%2Bquu%2B6UR8PTP5ooggGy4se3F4c6%2FypYfKv%2F5XBEEkA8%2FVr05PP1Vtvwk%2BLjxl88FQQD58GPVm%2FrTX3XdL8HH677yuSAIIB9%2BbHrH1eohEUWzVBXOEvx42Wd%2Ba4IA8mPIQgLlU39Zin4S9O2NC%2B%2FZeubkaRYGIKokCICoYXSqRXnbL2vw49CPHg8BAejBkawUyoU%2FGfwXJm5Idb%2B%2FF2AU%2FvS5GwhAH5YkJVF%2B%2Bqtu93UBrjSvvG%2Ff16a%2FTBJwZkqBAJgZTEVdyk%2F%2FrMFfjNvfvGnm0ber4IC2wxEAAXjsHVQLf6pn%2FLsmkqn%2FJ6qP7DkxFdU9NpvVqYEArMJtbzCqqf9CZauQBJDlb9vS%2Bfu3Pff0vVn6os9gBEAAHnoG1T3%2FPME%2F0V76hzefPvEOD83ldEogAKfw6x%2Bc6rpf9Ygvqv76fWOQRBCAHZytjULxuG%2FWNT%2Bq%2FubdBgRgHmNrI8TV6lERRdPWBkwxUN7gx1n%2FFCDnaAICyAEepa4UU%2F%2BsW31dXIvxypdumvnsXZRw9k0XEIAnFqWW%2BucNfpz2s%2BOYIAA7OBsdhdqWX97gl2C9Ur7%2BlttOTf2zUeAgHJ8G4%2B4DlNb98kqvXPO3imO5YMVR31zwKXVGBqAEF63GlPb7s9znH4Qmin52fQwEYBdvbaNRKvrlrfR3QZlcWfzCnmc%2B9wFtIEFQIgIggESI6DWgEvxZr%2FMOQhQn%2Fdz4GQjADe65RqVQ8de13pdA4IZfLnfI1RkEkAs%2B%2B50pBH%2BeY739iCH47ftQ74ggALf4K40eV6vTIoqOKnXS2Fhnyi%2FVwl6%2FRuNkFAUCyAic7W6u9%2Fp1PvW7wf97Bx55y8kHowXbWGK8%2F0cABMDAG1wGv%2B6nfjf4y636r%2BK1Xu6dDwTg3gYjNXCZ9ue5vz9sUjLtf8vCtw5Gc3PzxKEPQj0QAGEzuyr4yQr%2FpfHtym%2FrTYISBb8khOz%2FDgKwj3mqEV0Fv65DPaj2pzKz80YgAOcmuFYBF8Gvu8jXOys8%2BQk62ZpKIABCtlk74Sdf6HHIllpynX9x7MdyX%2BAZpi%2Fu9NuyZLZxQADZcNPey3bwm1rn9wKDz3dpdxPtAkEA2iFVF2jzVp%2BNwJcI4Eqvuh%2B46AECcIF6z5i29vhtBb78ZPeWlR8ew1d7HTtWyuFBACmBMtHMRrFPrvEXylu0b%2BkNwgPFPhNeYlYmCMAsvgOlr6X8sti329Twpot7%2FXpfV%2F%2FBR3bOfv4RU%2FOBXDMIgADM4DpUqsmUXx7bldt5Mvht%2FcmTfTjWawtt%2FeOAAPRjOjz4a7VZE1t8NtP83skh5bfoPIaGAgEYArZXrImUXxb1Fsa2CvnPvC%2FhzAIBqvxZUKPXBwRg2Ca6U37ba%2Ft%2BeHCwx7DDWBYPAjAE%2BNrruo%2FrKPS5SvF7ocFa35CjOBYLAtBsAB0n%2BmTAL5XWO0vv8dTX7BSExYEANBonT7pPLeglLLLIV2w17sOLOzQ6CTFRIAANBsmS7lMM%2BC4UK1Hp5cnWj%2B7f98zjD2mAByIIIwACyGGctOl%2Bd1%2BeUlo%2FbNq4wJPDIRh2BQFkMNrqtp4Qv9T%2Fhl55EGeptEE0CxWx%2Bu%2BOtugyTEnI6v6BhX%2F6KF7VlQU9vn1AAAq2k4F%2FaWLHx8ud5sFukMvunAJ9UIFvW%2FO%2FH8XlHQVH8KgpCCCFMeUa%2F9LEjl%2B5XN5y0MWhmxQqKjeRT%2FxLle1T%2BAS3MnRedQABjDCnDPzz6%2Fd8%2BEphsupT4I%2BJ1r17Zp54wStPxmQyIQACGADbhcMf%2FPWVYvlji%2BVNOzOhSqxTud0QEytXHnjTmafuIaYa1HGMAAhgzQDyaf%2FyxK7b68WJDy6VNzg2i57h23Hh1BsaF%2F8W13T14OmjlOAJ4JXb7vjzxcrmd%2FnytJdOKtf3SPN9DFf9cwqSAHwt6m1sLDyLp73%2BIPFZYjAE4GuKP9G%2Bcmbv4refxv69z2Fqbm7eEsDq8VwhhNy%2BWyquP%2BjLul6m98X2ytdLxXgGlXxzgRGKZK8IoPuUbxbH3lkvjO%2F0aesOQR9KSNqdJ2sC6AZ8pdM4%2BGp58y5fnvKXy1tm3tC8uFxsNZ%2FATTy7ARHaaCwIYPXSjRCH6qXJn1oob6349oRf11oU9dIEUvvQoo%2FAfMkRgHyqL5Y3lZdKG4%2FIJ%2FtyaXKXPGsv%2F3xK6RvF8QuTzR%2F9Owp4BKIgYBWsEoB8ki%2BWN%2F3MYmlzuR0VbyzHrV3LpYliMe7UmoWxqCOiHb4EedenZNFudW8ehbuAw4zu1I0SwItHjt0xHjfe1SpVbqsXJnbFUWE7XSiyaybfl1cQnbluoL88sWv2jc3%2FaqBKnx1T9LSDgFECGDQFSQry%2F3eKxSPyn3Gh9M7V%2FxbR6rl7aiQh344z1mmcFyL%2BntQv6rT%2FsxDH86LT%2BY9SOfo3BLkdR8UoZhCwTgBppvHd2z%2B0f6UV732tbaHw5vH28huvlCZL8v%2FVy%2BtKY%2B36KmE0RaVYEa0dSXKbovxSRTTbve1kMMv%2FXg3o7t9aYMv%2FRHAnoYrfuSNAkgC4gwr9gQAXBEAAXCwFPYGAAQRAAAZAhUggwAUBEAAXS0FPIGAAARCAAVAhEghwQQAEwMVS0BMIGEAABGAAVIgEAlwQ%2BF8Tl%2FF5tBvgLgAAAABJRU5ErkJggg%3D%3D&name=1&owner=1&pattern=Solid&pulls=1&stargazers=1&theme=Auto)
# XiaoqiangUpdater

>XiaoqiangUpdater 是一个通用的程序更新模块，主要为 Windows 项目设计，但理论上也适用于其他平台，用户可根据需求自行打包和测试。该模块提供自动检测、下载和安装更新的功能，并能在更新完成后自动重启主应用程序。开发这个模块的初衷是为了简化程序开发中的升级流程，让开发者可以方便地调用模块实现自动更新。

## 实现原理

该模块通过检查当前版本和最新版本之间的差异，从指定的URL下载更新包，并验证其完整性。然后将更新包解压到指定的安装路径，并重启主应用程序。

**使用该模块需要满足以下条件：**

1. 你的项目发布时打包成一个`zip格式`的压缩包。
2. 你的项目需要提供一个`exe入口文件`，用于启动更新程序。
3. 你的项目如果是多目录多文件，exe文件需要在你项目的根目录下。
4. 当你发布新版本的时候，建议保持`exe入口文件名`不变（例如：`app.exe`），否则需要你每次都在`updater_config.json`
   中修改`main_app`字段。

## 技术栈

- Python 3.11.5
- requests
- tkinter
- psutil
- pyinstaller

## 安装

使用 pip 安装：

```sh
pip install XiaoqiangUpdater
```

## 使用说明

### 参数说明

使用更新程序 `updater` 时，可以指定以下参数：

- `config_path`：配置文件路径（默认为 `updater_config.json`
  ，如果没有指定具体的配置文件路径，程序将自动在当前目录下遍历查找一个名叫 `updater_config.json` 的配置文件。）
- `--help`：显示此帮助信息并退出。

### 配置文件说明

示例配置文件 `updater_config.json` 的内容如下：

```json
{
  "current_version": "1.0.0",
  "latest_version": "1.1.0",
  "update_url": "http://example.com/updater.zip",
  "main_app": "app.exe",
  "verify_file_md5": "d41d8cd98f00b204e9800998ecf8427e",
  "logo_path": "path/to/logo.png",
  "open_current_version_on_fail": true,
  "install_dir": "path/to/install/directory"
}
```

#### 配置项说明

- `current_version`：当前版本号。
- `latest_version`：最新版本号。
- `update_url`：更新包的下载URL。
- `main_app`：主程序的路径（相对路径：一般都是放在根目录下的exe入口文件）。
- `verify_file_md5`：更新包校验文件的MD5值（可选），可以直接调用模块中的`get_file_md5`方法获取。
- `logo_path`：图形用户界面的图标路径（可选）。
- `open_current_version_on_fail`：更新失败或取消时是否打开当前版本的程序（可选）。默认是 `True`。
- `install_dir`：软件解压更新的目录（可选）。默认是 `updater.exe` 所在的目录。

**注意：**

1. 模块会自动使用 `updater.exe` 文件所在的目录与设置的相对路径或目录名进行拼接。
2. 如果没有指定具体的配置文件路径，程序将自动在当前目录下遍历查找一个名叫 `updater_config.json` 的配置文件。

#### 生成示例配置文件

- 你可以调用`updater_config_example方法`快速生成一个示例配置文件：

   ```python
   from XiaoqiangUpdater import updater_config_example

   if __name__ == '__main__':
       updater_config_example(save_path='updater_config.json')
   ```

### 打包更新程序

**直接使用**

- 第一种方式可以直接下载打包好的通用exe文件：[最新版下载地址](https://github.com/xiaoqiangclub/XiaoqiangUpdater/releases)

**手动打包**

- 配置updater(可默认)
   ```python
   from XiaoqiangUpdater import (updater, updater_config_example)

   
   def test_updater():
       updater_config_example(save_path='updater_config.json') # 这里为了方便生成一个示例配置文件，这里需要你根据自己的项目去生成
       updater(config_path='updater_config.json')   # 指定配置文件路径，不指定：默认会自动在当前目录下遍历查找名为updater_config.json的配置文件
   
   
   if __name__ == '__main__':
       test_updater()
   ```

- 调用`pack_to_exe`方法，将 `your_updater` 打包成可执行文件：
   ```python
   from XiaoqiangUpdater import pack_to_exe
   
   if __name__ == '__main__':
       pack_to_exe(main_file='test_updater.py', with_cmd_window=False, app_ico_logo=None)
   ```

## 项目中使用示例

```python
# _*_ coding : UTF-8 _*_
# 开发人员： Xiaoqiang
# 微信公众号: xiaoqiangclub
# 开发时间： 2024/5/25 11:01
# 文件名称： app.py
# 项目描述： 测试程序
# 开发工具： PyCharm
import os
import json
import subprocess
import sys
import tkinter as tk
from tkinter import ttk
from XiaoqiangUpdater import updater, updater_config_example


def app():
    root = tk.Tk()
    root.title("XiaoqiangClub")

    # 设置窗口大小
    root.geometry("400x200")

    # 设置窗口图标
    try:
        root.iconphoto(True, tk.PhotoImage(file="xiaoqiangclub_logo.png"))
    except Exception as e:
        print(f"Error loading logo: {e}")

    # 创建标签
    label = ttk.Label(root, text="XiaoqiangClub v1.0.0", font=("Helvetica", 24))
    label.pack(expand=True)

    root.mainloop()


def generate_config():
    """
    注意：这个函数仅用于生成示例配置文件，在实际使用中需要你自己去写这个函数。
    """
    config_path = os.path.join(os.getcwd(), "updater_config.json")
    updater_config_example(save_path=config_path)
    print(f"配置文件已生成：{config_path}")


# 用于生产环境调用exe文件
def main():
    try:
        # 调用生成配置文件函数
        generate_config()
        # 调用更新程序
        updater_path = os.path.join(os.getcwd(), "updater.exe")
        subprocess.Popen([updater_path])
        sys.exit()
    except Exception as e:
        print(f"检查更新时出错: {e}")


# 仅用于测试，调用updater.py中的start_update函数
def main_test():
    try:
        # 调用生成配置文件函数
        generate_config()
        # 调用更新逻辑
        updater("updater_config.json")
        sys.exit()
    except Exception as e:
        print(f"检查更新时出错: {e}")


if __name__ == "__main__":
    # 生产环境使用：
    # main()

    # 测试使用：
    main_test()
    # 启动应用程序
    app()
```

## 注意事项

- `generate_config`方法需要你自己去写，用于生成配置文件。
- 请确保更新URL和文件路径正确，并且更新包完整。
- 为了确保安全，建议验证下载文件的完整性。
- 请根据实际情况修改主应用程序中的更新检查逻辑和参数配置。

![支持我](https://gitee.com/xiaoqiangclub/xiaoqiangapps/raw/master/images/xiaoqiangclub_ad.png)